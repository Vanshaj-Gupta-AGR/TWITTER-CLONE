var timer,selectedUsers=[];function searchUsers(e){$.ajax({url:"/api/us/sr",type:"post",data:{obj:e},success:e=>{console.log(e),outputSelectableUsers(e.result,e.user,$(".resultsContainer"))}})}function outputSelectableUsers(e,s,t){t.html(""),e.forEach((e=>{if(e._id!=s._id&&!selectedUsers.some((s=>s._id==e._id))){var r=createUserHtml(e,!0),a=$(r);a.click((()=>{userSelected(e)})),t.append(a)}})),0==e.length&&t.append("<span class='noResults'>No results found</span>")}function createUserHtml(e,s){console.log(e.name);var t=e.name;user.following&&user.following.includes(e._id);return`<div class='user'>\n                <div class='userImageContainer'>\n                    <img src='${e.profilePic}'>\n                </div>\n                <div class='userDetailsContainer'>\n                    <div class='header'>\n                        <a href='/users/profile/${e._id}'>${t}</a>\n                        <span class='username'>@${e.name}</span>\n                    </div>\n                </div>\n                \n            </div>`}function userSelected(e){selectedUsers.push(e),updateSelectedUsersHtml(),$("#userSearchTextBox").val("").focus(),$(".resultsContainer").html(""),$("#createChatButton").prop("disabled",!1)}function updateSelectedUsersHtml(){var e=[];selectedUsers.forEach((s=>{var t=s.name,r=$(`<span class="selectedUser">${t}</span>`);e.push(r)})),$(".selectedUser").remove(),$(".selectedUsers").prepend(e)}$("#userSearchTextBox").keydown((e=>{clearTimeout(timer);var s=$(e.target),t=s.val();if(""==t&&(8==e.which||8==e.keyCode))return selectedUsers.pop(),updateSelectedUsersHtml(),$(".resultsContainer").html(""),void(0==selectedUsers.length&&$("#createChatButton").prop("disabled",!0));timer=setTimeout((()=>{""==(t=s.val().trim())?$(".resultsContainer").html(""):searchUsers(t)}),1e3)})),$("#createChatButton").click((()=>{var e=JSON.stringify(selectedUsers);$.post("/messages/chat",{users:e},(e=>{console.log(e),window.location.href=`/messages/${e._id}`}))}));